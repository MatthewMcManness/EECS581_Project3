ScreenManager:
    id: screen_manager
    CalendarView:
    ToDoListView:

<CalendarView>:
    name: "calendar"

    BoxLayout:
        orientation: 'vertical'

        # Header with calendar title and menu button
        BoxLayout:
            size_hint_y: None
            height: dp(50)
            Label:
                text: "Calendar"
                font_size: dp(20)
                size_hint_x: 1
            Button:
                text: "Menu"
                size_hint_x: 0.2
                on_press: app.open_menu()

        # Month navigation with Previous and Next buttons
        BoxLayout:
            size_hint_y: None
            height: dp(40)
            Button:
                text: "Previous"
                on_press: root.change_month(-1)  # Calls change_month in CalendarView
            Label:
                text: root.month_year_text  # Binds to the month_year_text property
                font_size: dp(18)
            Button:
                text: "Next"
                on_press: root.change_month(1)

        # Header for weekdays
        BoxLayout:
            size_hint_y: None
            height: "50dp"
            Label:
                text: "Mon"
                halign: "center"
            Label:
                text: "Tue"
                halign: "center"
            Label:
                text: "Wed"
                halign: "center"
            Label:
                text: "Thu"
                halign: "center"
            Label:
                text: "Fri"
                halign: "center"
            Label:
                text: "Sat"
                halign: "center"
            Label:
                text: "Sun"
                halign: "center"

        # Scrollable calendar grid for day buttons
        ScrollView:
            do_scroll_x: False
            do_scroll_y: True
            GridLayout:
                id: calendar_grid
                cols: 7
                padding: dp(10)
                spacing: dp(1)
                row_default_height: dp(60)
                row_force_default: True
                adaptive_height: True  # Ensures it adapts to content

        # Button to open Add Task popup
        BoxLayout:
            size_hint_y: 0.2
            Button:
                text: "Open Add Task Popup"
                on_release: app.open_add_event_modal()

        # Button to switch to To-Do List
        BoxLayout:
            size_hint_y: 0.2
            Button:
                text: "Go to To-Do List"
                on_release: app.switch_to_screen("todo")

<ToDoListView>:
    name: "todo"

    BoxLayout:
        orientation: 'vertical'

        # Header with To-Do List title
        BoxLayout:
            size_hint_y: None
            height: dp(50)
            Label:
                text: "To-Do List"
                font_size: dp(20)
                size_hint_x: 1

        # Sort options and add task button
        BoxLayout:
            size_hint_y: None
            height: "50dp"
            padding: "10dp"
            spacing: "10dp"

            Button:
                text: "Add Task"
                on_release: app.open_add_task_modal()

            Spinner:
                text: "Sort by"
                values: ["Priority", "Due Date", "Category"]
                on_text: root.sort_tasks(self.text.lower())

            Button:
                text: "Calendar View"
                on_release: app.switch_to_screen("calendar")

        # Scrollable task list
        ScrollView:
            GridLayout:
                id: task_list
                cols: 1
                spacing: "5dp"
                size_hint_y: None
                height: self.minimum_height

                # Sample task item
                BoxLayout:
                    padding: "2dp"
                    spacing: "2dp"
                    size_hint_y: None
                    height: "30dp"
                    canvas.before:
                        Color:
                            rgba: (0.9, 0.9, 0.9, 1) if self.height > 50 else (1, 1, 1, 1)
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    
                    Label:
                        text: "C"
                        size_hint_x: 0.1
                        color: (0.9, 0.9, 0.9, 1)
                    
                    Label:
                        text: "Task Title"
                        size_hint_x: 0.5
                        color: (0, 0, 0, 1)

                    Label:
                        text: "Due Date"
                        size_hint_x: 0.3
                        color: (0, 0, 0, 1)

                    Label:
                        text: "!"
                        size_hint_x: 0.1
                        color: (1, 0, 0, 1)  # Red exclamation for priority
                        font_size: "24sp"

                    Label:
                        text: "Category"
                        size_hint_x: 0.2
                        color: (0, 0, 0, 1)
                    
                BoxLayout:
                    padding: "5dp"
                    spacing: "5dp"
                    size_hint_y: None
                    height: "60dp"
                    canvas.before:
                        Color:
                            rgba: (0.9, 0.9, 0.9, 1) if self.height > 50 else (1, 1, 1, 1)
                        Rectangle:
                            size: self.size
                            pos: self.pos
                            
                    CheckBox:
                        size_hint_x: 0.1
                        on_active: app.mark_task_complete(self, "Homework")
                        
                    Label:
                        text: "Homework"
                        size_hint_x: 0.5
                        color: (0, 0, 0, 1)

                    Label:
                        text: "11/03/2024"
                        size_hint_x: 0.3
                        color: (0, 0, 0, 1)

                    Label:
                        text: ""
                        size_hint_x: 0.1
                        color: (1, 0, 0, 1)  # Red exclamation for priority
                        font_size: "24sp"

                    Label:
                        text: "School"
                        size_hint_x: 0.2
                        color: (0, 0, 0, 1)
                    
                BoxLayout:
                    padding: "5dp"
                    spacing: "5dp"
                    size_hint_y: None
                    height: "60dp"
                    canvas.before:
                        Color:
                            rgba: (0.9, 0.9, 0.9, 1) if self.height > 50 else (1, 1, 1, 1)
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    
                    CheckBox:
                        size_hint_x: 0.1
                        on_active: app.mark_task_complete()
                    
                    Label:
                        text: "Study for Midterm"
                        size_hint_x: 0.5
                        color: (0, 0, 0, 1)

                    Label:
                        text: "11/11/2024"
                        size_hint_x: 0.3
                        color: (0, 0, 0, 1)

                    Label:
                        text: "!!!"
                        size_hint_x: 0.1
                        color: (1, 0, 0, 1)  # Red exclamation for priority
                        font_size: "24sp"

                    Label:
                        text: "School"
                        size_hint_x: 0.2
                        color: (0, 0, 0, 1)
                    
                BoxLayout:
                    padding: "5dp"
                    spacing: "5dp"
                    size_hint_y: None
                    height: "60dp"
                    canvas.before:
                        Color:
                            rgba: (0.9, 0.9, 0.9, 1) if self.height > 50 else (1, 1, 1, 1)
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    
                    CheckBox:
                        size_hint_x: 0.1
                        on_active: app.mark_task_complete()
                    
                    Label:
                        text: "Buy gift for Magaly"
                        size_hint_x: 0.5
                        color: (0, 0, 0, 1)

                    Label:
                        text: "12/10/2024"
                        size_hint_x: 0.3
                        color: (0, 0, 0, 1)

                    Label:
                        text: "!"
                        size_hint_x: 0.1
                        color: (1, 0, 0, 1)  # Red exclamation for priority
                        font_size: "24sp"

                    Label:
                        text: "Personal"
                        size_hint_x: 0.2
                        color: (0, 0, 0, 1)
                    
                BoxLayout:
                    padding: "5dp"
                    spacing: "5dp"
                    size_hint_y: None
                    height: "60dp"
                    canvas.before:
                        Color:
                            rgba: (0.9, 0.9, 0.9, 1) if self.height > 50 else (1, 1, 1, 1)
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    
                    CheckBox:
                        size_hint_x: 0.1
                        on_active: app.mark_task_complete()
                    
                    Label:
                        text: "Submit Project"
                        size_hint_x: 0.5
                        color: (0, 0, 0, 1)

                    Label:
                        text: "12/20/2024"
                        size_hint_x: 0.3
                        color: (0, 0, 0, 1)

                    Label:
                        text: "!!"
                        size_hint_x: 0.1
                        color: (1, 0, 0, 1)  # Red exclamation for priority
                        font_size: "24sp"

                    Label:
                        text: "School"
                        size_hint_x: 0.2
                        color: (0, 0, 0, 1)



        # Footer with Add Task button
        BoxLayout:
            size_hint_y: None
            height: dp(50)
            Button:
                text: "Add Task"
                on_release: app.open_add_task_modal()
